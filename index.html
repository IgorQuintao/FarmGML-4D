<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmGML-4D</title>
    <link href="Cesium-1.135/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";}
        #cesiumContainer { width: 100%; height: 100vh; }
        /* */
        #toolbar {
            position: absolute; /* Flutua sobre o mapa */
            top: 10px;
            left: 10px;
            background-color: rgba(40, 40, 40, 0.8);
            padding: 8px;
            border-radius: 5px;
            z-index: 1; /* Garante que fique sobre o Cesium */
            min-width: 150px; /* Largura mínima */
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            font-family: sans-serif;
            color: white;
        }

        /* Estilo para todos os elementos de formulário */
        #toolbar button, #toolbar select {
            width: 100%;
            padding: 8px 10px;
            margin-bottom: 8px;
            background-color: #303030;
            color: white;
            border: 1px solid #444;
            border-radius: 3px;
            cursor: pointer;
            box-sizing: border-box; /* Garante que o padding não afete a largura */
            font-size: 14px;
        }

        #toolbar button:hover, #toolbar select:hover {
            background-color: #484848;
        }

        /* Div para o "Toggle" */
        .toggle-container {
            display: flex;
            justify-content: space-between; /* Alinha "Toggle" e o switch */
            align-items: center;
            padding: 8px 4px;
        }

        /* --- CSS para o "Toggle Switch" (chave seletora) --- */
        /* O contêiner do switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 46px; /* Largura do switch */
            height: 26px; /* Altura do switch */
        }

        /* Esconde o checkbox HTML padrão */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* O "trilho" deslizante */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 34px;
        }

        /* O "círculo" que se move */
        .slider:before {
            position: absolute;
            content: "";
            height: 18px; /* Tamanho do círculo */
            width: 18px;  /* Tamanho do círculo */
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 50%;
        }

        /* O que acontece quando está MARCADO (checked) */
        input:checked + .slider {
            background-color: #57b32c; /* Cor verde do Sandcastle */
        }

        input:checked + .slider:before {
            /* Move o círculo para a direita */
            -webkit-transform: translateX(20px);
            -ms-transform: translateX(20px);
            transform: translateX(20px);
        }
        /* --- Fim do CSS do "Toggle Switch" --- */

    </style>
</head>
<body>
    
    <div id="toolbar">
        <button id="btnHome">Ir para Casa (Brasil)</button>
        
        <div class="toggle-container">
            <span>Ver Edificações</span>
            <label class="switch">
                <input type="checkbox" id="togglePredios" checked>
                <span class="slider"></span>
            </label>
        </div>

        <select id="menuLocalizacao">
            <option value="vicosa">Ir para Viçosa</option>
            <option value="brasilia">Ir para Brasília</option>
            <option value="rio">Ir para Rio de Janeiro</option>
        </select>
    </div>
    
    <div id="cesiumContainer"></div>

    <script src="Cesium-1.135/Build/Cesium/Cesium.js"></script>

    <script>
        // Define o token de acesso no objeto global 'Cesium'
        Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwZjU1NjM1Mi05Y2VmLTQzNWQtOWJlZC1lN2ZjOTQ5NTRjNjgiLCJpZCI6MjQ1ODA1LCJpYXQiOjE3MjgwMDc2NTZ9.llL11YcDPkvbe-fCSRdKcOSqjylh8BGXgPLRZKupKoU';
        // 4. Precisamos envolver nosso código em uma função 'async'
        //    para poder usar a palavra-chave 'await'.
        async function setupCesium() {

            // 5. Todas as classes do Cesium agora são acessadas
            //    através do objeto global 'Cesium.'
            const viewer = new Cesium.Viewer('cesiumContainer', {
                terrain: Cesium.Terrain.fromWorldTerrain(),
            });

            // Fly the camera to San Francisco at the given longitude, latitude, and height.
            viewer.camera.flyTo({
                destination: Cesium.Cartesian3.fromDegrees(-42.8775,-20.7555, 15000),
                orientation: {
                    heading: Cesium.Math.toRadians(0.0),
                    pitch: Cesium.Math.toRadians(-90.0),
                }
            });
            
            // Add Cesium OSM Buildings, a global 3D buildings layer.
            const buildingTileset = await Cesium.createOsmBuildingsAsync();
            viewer.scene.primitives.add(buildingTileset);
       
            // --- ---

            // 1. Conectar o botão "Ir para Casa"
            document.getElementById('btnHome').addEventListener('click', function() {
                console.log('Botão "Home" clicado!');
                // Voa para uma nova localização (ex: Brasil)
                viewer.camera.flyTo({
                    destination: Cesium.Cartesian3.fromDegrees(-42.8775,-20.7555, 15000), // Viçosa
                    orientation: {
                        heading: Cesium.Math.toRadians(0.0),
                        pitch: Cesium.Math.toRadians(-90.0),
                    }
                });
            });

            // 2. Conectar a caixa "Mostrar Prédios" (toggle)
            document.getElementById('togglePredios').addEventListener('change', function(evento) {
                // 'evento.target.checked' nos diz se a caixa está marcada
                const estaMarcado = evento.target.checked;
                console.log('Toggle mudou para:', estaMarcado);
                
                // Acessamos o 'buildingTileset' que carregamos lá em cima
                buildingTileset.show = estaMarcado;
                buildingTileset.show = evento.target.checked;
            });

            // 3. Conectar o Menu <select>
            document.getElementById('menuLocalizacao').addEventListener('change', function(evento) {
                const local = evento.target.value; // "vicosa", "brasilia" ou "rio"
                
                if (local === 'vicosa') {
                    // Voa para Viçosa
                    viewer.camera.flyTo({
                        destination: Cesium.Cartesian3.fromDegrees(-42.8775,-20.7555, 15000),
                        orientation: {
                            heading: Cesium.Math.toRadians(0.0),
                            pitch: Cesium.Math.toRadians(-90.0),
                        }
                    });
                } else if (local === 'brasilia') {
                    // Voa para Brasília
                    viewer.camera.flyTo({
                        destination: Cesium.Cartesian3.fromDegrees(-47.9292, -15.7801, 15000),
                    });
                } else if (local === 'rio') {
                    // Voa para o Rio de Janeiro
                    viewer.camera.flyTo({
                        destination: Cesium.Cartesian3.fromDegrees(-43.1729, -22.9068, 5000),
                    });
                }
            });


        }
        
        // 6. Chame a função para executar o código
        setupCesium();
        


    </script>
</body>
</html>